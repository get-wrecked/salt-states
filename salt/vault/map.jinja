{% set pillar_get = salt['pillar.get'] %}

{% set vault = salt['grains.filter_by']({
    'default': {
        'version_spec': '1.3.2 sha256=6e72132de0421b74d909f50be1823fe57182694c4268ba9a38c31213d9497ec9',
        'config': {
            'listener': {
                'tcp': {
                    'tls_cert_file': '/etc/vault/cert.pem',
                    'tls_key_file': '/etc/vault/key.pem',
                    'tls_prefer_server_ciphers': 'true',
                    'tls_cipher_suites': ','.join([
                        'TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384',
                        'TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256',
                        'TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305',
                        'TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256',
                    ]),
                },
            },
        },
    },
}, merge=pillar_get('vault')) %}
